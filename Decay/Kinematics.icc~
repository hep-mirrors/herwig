// -*- C++ -*-
//
// This is the implementation of the inlined member functions of
// the Kinematics class.
//
 
namespace Herwig {


  inline Energy Kinematics::pstarTwoBodyDecay(const Energy M, 
					      const Energy m1, const Energy m2) {
    return ( M <= 0.0  ||  m1 < 0.0  ||  m2 < 0.0  ||  M <= m1+m2  ?  0.0  : 
	     sqrt(( M*M - (m1+m2)*(m1+m2) )*( M*M - (m1-m2)*(m1-m2) )) / (2.0*M) ); 
  }
 

  inline Vector3 Kinematics::unitDirection(const double cosTheta, const double phi) {
    return ( fabs( cosTheta ) > 1.0  ?  Vector3() :
	     Vector3( cos(phi)*sqrt(1.0-cosTheta*cosTheta) , 
		      sin(phi)*sqrt(1.0-cosTheta*cosTheta) , cosTheta) );
  }


  void Kinematics::twoBodyDecay(const Lorentz5Momentum & p,                         
				const double m1, const double m2,                 
				const double cosThetaStar1, const double phiStar1, 
				Lorentz5Momentum & p1, Lorentz5Momentum & p2 ) {
    twoBodyDecay(p,m1,m2,unitDirection(cosThetaStar1,phiStar1),p1,p2);
  }


}
