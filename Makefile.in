SUBDIRS = Config Utilities Decay Hadronization Shower \
	  MatrixElement PDF UnderlyingEvent PDT Helicity Helicity/Vertex \
	  Decay/FormFactors Helicity/Vertex/Vector Helicity/Vertex/Scalar \
	  Helicity/Vertex/Tensor Helicity/Vertex/StandardModel Decay/VectorMeson \
	  Decay/TensorMeson Decay/ScalarMeson Decay/WeakCurrents Models \
	  Helicity/Vertex/RSModel Decay/Tau Decay/Baryon Decay/Perturbative

SRCDIR = @BUILDDIR@

DISTFILES = README Makefile configure configure.in

VERSION = 0.9

TAG = Herwig++-$(VERSION)

.PHONY: lib all depend clean nodebug setup

all: lib

check: lib
	cd src ;  $(MAKE) -$(MAKEFLAGS) check ; cd ..

lib:
	for dir in $(SUBDIRS); do cd $$dir ; $(MAKE) -$(MAKEFLAGS) lib; cd $(SRCDIR); done;

clean: 
	for dir in $(SUBDIRS) src; do cd $$dir ; $(MAKE) -$(MAKEFLAGS) clean ; cd $(SRCDIR) ; rm lib/*.*o ; done

distclean: clean
	cd src ; $(MAKE) -$(MAKEFLAGS) distclean ; cd .. 
	rm -f config.cache config.status config.log Config/Makefile.common Config/config.h

depend: 
	for dir in $(SUBDIRS) src ; do cd $$dir ; $(MAKE) -$(MAKEFLAGS) depend ; cd $(SRCDIR) ; done

install: lib
	for dir in $(SUBDIRS) src ; do cd $$dir ; $(MAKE) VERSION=$(VERSION) -$(MAKEFLAGS) install ; cd $(SRCDIR) ; done

doc:
	@cd Doc ; $(MAKE) doc ; cd ..

dist: doc
	rm -rf $(TAG)
	mkdir -p $(TAG)/Herwig
	cp $(DISTFILES) $(TAG)/Herwig
	for dir in $(SUBDIRS) src Doc Templates ; do cd $$dir ; $(MAKE) -$(MAKEFLAGS) TAGDIR=$(TAG)/Herwig VERSION=$(VERSION) dist ; cd .. ; done
	tar czf $(TAG).tgz $(TAG)
	rm -rf $(TAG)

configure: configure.in
	autoconf

