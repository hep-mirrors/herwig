#! /usr/bin/env python
import logging
import sys

if sys.version_info[:3] < (2,4,0):
    print "rivet scripts require Python version >= 2.4.0... exiting"
    sys.exit(1)

import os, yoda

# #############################################


def fillAbove(scale,desthisto, sourcehistosbyptmin) :
    pthigh= 1e100
    ptlow =-1e100
    for pt, h in sorted(sourcehistosbyptmin.iteritems(),reverse=True):
        ptlow=pt
        if(type(desthisto)==yoda.core.Scatter2D) :
            for i in range(0,h.numPoints) :
                xMin = h.points[i].x-h.points[i].xErrs.minus
                if( xMin*scale >= ptlow and 
                    xMin*scale <  pthigh ) :
                    desthisto.addPoint(h.points[i])
        elif(type(desthisto)==yoda.core.Profile1D) :
            for i in range(0,h.numBins) :
                if(h.bins[i].xMin*scale  >= ptlow and 
                   h.bins[i].xMin*scale  <  pthigh ) :
                    desthisto.bins[i] += h.bins[i]
        elif(type(desthisto)==yoda.core.Histo1D) :
            for i in range(0,h.numBins) :
                if(h.bins[i].xMin*scale  >= ptlow and 
                   h.bins[i].xMin*scale  <  pthigh ) :
                    desthisto.bins[i] += h.bins[i]
        else :
            logging.error("Can't merge %s, unknown type" % desthisto.path)
            sys.exit(1)
        pthigh=pt

def mergeByPt(hpath, sqrts, scale=1.) :
    global inhistos_pt
    global outhistos
    try:
        fillAbove(scale,outhistos[hpath], inhistos_pt[hpath][float(sqrts)])
    except:
        pass

def mergeByMass(hpath, sqrts, scale=1.):
    global inhistos_mass
    global outhistos
    try:
        fillAbove(scale,outhistos[hpath], inhistos_mass[hpath][float(sqrts)])
    except:
        pass

def useOnePt(hpath, sqrts, ptmin):
    global inhistos_pt
    global outhistos
    try:
       ## Find best pT_min match
        ptmins = inhistos_pt[hpath][float(sqrts)].keys()
        closest_ptmin = None
        for ptm in ptmins:
            if closest_ptmin is None or \
                    abs(ptm-float(ptmin)) < abs(closest_ptmin-float(ptmin)):
                closest_ptmin = ptm
        if closest_ptmin != float(ptmin):
            logging.warning("Inexact match for requested pTmin=%s: " % ptmin + \
                                "using pTmin=%e instead" % closest_ptmin)
        outhistos[hpath] =  inhistos_pt[hpath][float(sqrts)][closest_ptmin]
    except:
        pass

def useOneMass(hpath, sqrts, ptmin):
    global inhistos_pt
    global outhistos
    try:
       ## Find best pT_min match
        ptmins = inhistos_mass[hpath][float(sqrts)].keys()
        closest_ptmin = None
        for ptm in ptmins:
            if closest_ptmin is None or \
                    abs(ptm-float(ptmin)) < abs(closest_ptmin-float(ptmin)):
                closest_ptmin = ptm
        if closest_ptmin != float(ptmin):
            logging.warning("Inexact match for requested pTmin=%s: " % ptmin + \
                                "using pTmin=%e instead" % closest_ptmin)
        outhistos[hpath] =  inhistos_mass[hpath][float(sqrts)][closest_ptmin]
    except:
        pass

# #######################################

if __name__ == "__main__":
    import logging
    from optparse import OptionParser, OptionGroup
    parser = OptionParser(usage="%prog name")
    verbgroup = OptionGroup(parser, "Verbosity control")
    parser.add_option("--with-ue",
                      action='store_true' ,
                      dest="ue",
                      default=True,
                      help="Include UE analyses")
    parser.add_option("--without-ue",
                      action='store_false',
                      dest="ue",
                      default=True,
                      help="Don\'t include UE analyses")
    verbgroup.add_option("-v", "--verbose", action="store_const", const=logging.DEBUG, dest="LOGLEVEL",
                         default=logging.INFO, help="print debug (very verbose) messages")
    verbgroup.add_option("-q", "--quiet", action="store_const", const=logging.WARNING, dest="LOGLEVEL",
                         default=logging.INFO, help="be very quiet")
    parser.add_option_group(verbgroup)
    (opts, args) = parser.parse_args()
    logging.basicConfig(level=opts.LOGLEVEL, format="%(message)s")

    (opts, args) = parser.parse_args()

    ## Check args
    if len(args) < 1:
        logging.error("Must specify at least the name of the files")
        sys.exit(1)
 
yodafiles=["-7-Jets-1.yoda","-7-Jets-2.yoda",
           "-7-Jets-3.yoda","-7-Jets-4.yoda","-7-Jets-5.yoda",
           "-7-Jets-6.yoda","-7-Jets-7.yoda","-7-Jets-8.yoda",
           "-7-Bottom-0.yoda","-7-Bottom-1.yoda","-7-Bottom-2.yoda",
           "-7-Bottom-3.yoda","-7-Bottom-4.yoda","-7-Bottom-5.yoda",
           "-7-Charm-1.yoda","-7-Charm-2.yoda",
           "-7-Charm-3.yoda","-7-Charm-4.yoda","-7-Charm-5.yoda",
           "-7-Top-SL.yoda","-7-Top-L.yoda","-7-Top-All.yoda"]

if(opts.ue) :
    yodafiles += ["-7-Jets-0.yoda","-900-UE.yoda"   ,"-2360-UE.yoda"    ,"-2760-UE.yoda"    ,
                  "-7-UE.yoda"     ,"-900-UE-Long.yoda","-8-UE.yoda",
                  "-7-UE-Long.yoda","-13-UE.yoda"]
## Get histos
inhistos_pt   = {}
inhistos_mass = {}
outhistos={}
weights = {}
for f in yodafiles:
    file=args[0]+f
    sqrts=7000
    if(file.find("-900-UE")>0) :
        sqrts=900
        ptmin=0.
    elif(file.find("-2360-UE")>0) :
        sqrts=2360
        ptmin=0.
    elif(file.find("-2760-UE")>0) :
        sqrts=2760
        ptmin=0.
    elif(file.find("-7-UE")>0) :
        ptmin=0.
    elif(file.find("-13-UE")>0) :
        ptmin=0.
        sqrts=13000
    elif(file.find("-7-Jets-0")>0) :
        ptmin=4.
    elif(file.find("-7-Jets-1")>0) :
        if( not opts.ue) :
            ptmin = 10.
        else :
            ptmin = 20.
    elif(file.find("-7-Jets-2")>0) :
        ptmin=40.
    elif(file.find("-7-Jets-3")>0) :
        ptmin=80.
    elif(file.find("-7-Jets-4")>0) :
        ptmin=110.
    elif(file.find("-7-Jets-5")>0) :
        ptmin=210.
    elif(file.find("-7-Jets-6")>0) :
        ptmin=260.
    elif(file.find("-7-Jets-7")>0) :
        ptmin=400.
    elif(file.find("-7-Jets-8")>0) :
        ptmin=600.
    elif(file.find("-7-Bottom-0")>0) :
        ptmin=0.
    elif(file.find("-7-Bottom-1")>0 or file.find("-7-Charm-1")>0) :
        ptmin=10.
    elif(file.find("-7-Bottom-2")>0 or file.find("-7-Charm-2")>0) :
        ptmin=30.
    elif(file.find("-7-Bottom-3")>0 or file.find("-7-Charm-3")>0) :
        ptmin=70.
    elif(file.find("-7-Bottom-4")>0 or file.find("-7-Charm-4")>0) :
        ptmin=100.
    elif(file.find("-7-Bottom-5")>0 or file.find("-7-Charm-5")>0) :
        ptmin=130.
    elif(file.find("-7-Top-SL.yoda")>0 or file.find("-7-Top-L.yoda")>0 or \
         file.find("-7-Top-All.yoda")>0):
        ptmin=0.
    if not os.access(file, os.R_OK):
        logging.error("%s can not be read" % file)
        continue
    try:
        aos = yoda.read(file)
    except:
        logging.error("%s can not be parsed as YODA" % file)
        continue
    ## Get histos from this YODA file
    for aopath, ao in aos.iteritems() :
        if(aopath.find("S8924791")>0 or 
           aopath.find("S8971293")>0 or 
           aopath.find("S8817804")>0 or 
           aopath.find("I1082936")>0 or 
           aopath.find("S8994773")>0 or 
           aopath.find("S8918562")>0 or 
           aopath.find("S8624100")>0 or 
           aopath.find("S8625980")>0 or 
           aopath.find("S8894728")>0 or 
           aopath.find("S8957746")>0 or 
           aopath.find("S9126244")>0 or 
           aopath.find("S9120041")>0 or 
           aopath.find("S8950903")>0 or 
           aopath.find("S9086218")>0 or 
           aopath.find("S9088458")>0 or 
           aopath.find("I919017" )>0 or
           aopath.find("I926145" )>0 or
           aopath.find("S8941262")>0 or
           aopath.find("S8973270")>0 or
           aopath.find("I1118269")>0 or
           aopath.find("I1188891")>0 or
           aopath.find("I1082009")>0 or
           aopath.find("I1087342")>0 or
           aopath.find("S9035664")>0 or
           aopath.find("I1125575")>0 or
           aopath.find("I1094564")>0 or
           aopath.find("I930220")>0 or
           aopath.find("I1224539")>0 or
           aopath.find("I1273574")>0 or
           aopath.find("I1261026")>0 or
           aopath.find("I1307243")>0 or
           aopath.find("I1325553")>0 or
           aopath.find("I1298810")>0 or
           aopath.find("CMS_2012_PAS_QCD_11_010")>0 or
           aopath.find("CMS_2013_I1208923")>0 or
           aopath.find("ATLAS_2014_I1298811")>0) :
           if not inhistos_pt.has_key(aopath):
               inhistos_pt[aopath] = {}
           tmpE = inhistos_pt[aopath]
           if not tmpE.has_key(sqrts):
               tmpE[sqrts] = {}
           if not tmpE[sqrts].has_key(ptmin):
               tmpE[sqrts][ptmin] = ao
           else:
               tmpE[sqrts][ptmin] += ao
               #raise Exception("A set with ptmin = %s already exists" % ( ptmin))



        else :
            if(aopath.find("I1243871")>0) :
                if(aopath.find("x01")>0 and file.find("-7-Top-L.yoda")>0 ) :
                    outhistos[aopath] = ao
                elif(aopath.find("x02")>0 and file.find("-7-Top-SL.yoda")>0 ) :
                    outhistos[aopath] = ao
            else :
                outhistos[aopath] = ao

yodafiles=["-7-Jets-1.yoda" ,"-7-Jets-9.yoda" ,"-7-Jets-10.yoda",
           "-7-Jets-11.yoda","-7-Jets-12.yoda","-7-Jets-13.yoda",
           "-7-Jets-14.yoda","-7-Jets-15.yoda",
           "-7-Bottom-6.yoda","-7-Bottom-7.yoda","-7-Bottom-8.yoda"]

for f in yodafiles:
    file=args[0]+f
    if(file.find("-7-Jets-1.yoda")>0) :
        sqrts=7000
        mass=0
    if(file.find("-7-Jets-9.yoda")>0) :
        sqrts=7000
        mass=100
    elif(file.find("-7-Jets-10.yoda")>0) :
        sqrts=7000
        mass=250
    elif(file.find("-7-Jets-11.yoda")>0) :
        sqrts=7000
        mass=650
    elif(file.find("-7-Jets-12.yoda")>0) :
        sqrts=7000
        mass=1100
    elif(file.find("-7-Jets-13.yoda")>0) :
        sqrts=7000
        mass=1700
    elif(file.find("-7-Jets-14.yoda")>0) :
        sqrts=7000
        mass=2300
    elif(file.find("-7-Jets-15.yoda")>0) :
        sqrts=7000
        mass=2900
    elif(file.find("-7-Bottom-6.yoda")>0) :
        sqrts=7000
        mass=110
    elif(file.find("-7-Bottom-7.yoda")>0) :
        sqrts=7000
        mass=370
    elif(file.find("-7-Bottom-8.yoda")>0) :
        sqrts=7000
        mass=550
    if not os.access(file, os.R_OK):
        logging.error("%s can not be read" % file)
        continue
    try:
        aos = yoda.read(file)
    except:
        logging.error("%s can not be parsed as YODA" % file)
        continue
    ## Get histos from this YODA file
    for aopath, ao in aos.iteritems() :
        if(aopath.find("8817804")>0 or
           aopath.find("1082936")>0 or
           aopath.find("I930220")>0 or
           aopath.find("1261026")>0 or
           aopath.find("1090423")>0 or
           aopath.find("1268975")>0 or
           aopath.find("CMS_2013_I1208923")>0) :
           if not inhistos_mass.has_key(aopath):
               inhistos_mass[aopath] = {}
           tmpE = inhistos_mass[aopath]
           if not tmpE.has_key(sqrts):
               tmpE[sqrts] = {}
           tmpP = tmpE[sqrts]
           if not tmpP.has_key(mass):
               tmpP[mass] = ao
           else:
                raise Exception("A set with mass = %s already exists" % ( mass))

## Make empty output histos if needed
for hpath,hsets in inhistos_pt.iteritems():
    if( hpath.find("8924791")>0  or 
        hpath.find("8971293")>0 or 
        hpath.find("8817804")>0 or 
        hpath.find("8968497")>0 or 
        (hpath.find("9120041")>0 and (hpath.find("d01")>0 or hpath.find("d02")>0)) or 
        hpath.find("9126244")>0 or 
        hpath.find("926145") >0 or 
        hpath.find("9086218")>0 or 
        hpath.find("1082936")>0 or 
        hpath.find("8941262")>0 or 
        hpath.find("1118269")>0 or 
        hpath.find("1087342")>0 or 
        hpath.find("1188891")>0 or
        hpath.find("919017")>0  or
        hpath.find("9035664")>0 or
        hpath.find("1125575")>0 or
        hpath.find("1094564")>0 or
        hpath.find("I930220")>0 or
        hpath.find("S9088458")>0 or 
        hpath.find("I1273574")>0 or 
        hpath.find("I1261026")>0 or 
        hpath.find("I1090423")>0 or
        hpath.find("QCD_11_010")>0 or
        hpath.find("1298811"   )>0 or
        hpath.find("I1325553"  )>0 or
        hpath.find("I1298810"  )>0 or
        hpath.find("1307243"   )>0 or
        hpath.find("CMS_2013_I1208923"   )>0) :
        if(type(hsets.values()[0].values()[0])==yoda.core.Scatter2D) :
            outhistos[hpath] = yoda.core.Scatter2D(hsets.values()[0].values()[0].path,
                                                   hsets.values()[0].values()[0].title)
        elif(type(hsets.values()[0].values()[0])==yoda.core.Profile1D) :
            outhistos[hpath] = yoda.core.Profile1D(hsets.values()[0].values()[0].path,
                                                   hsets.values()[0].values()[0].title)
            for i in range(0,hsets.values()[0].values()[0].numBins) :
                outhistos[hpath].addBin(hsets.values()[0].values()[0].bins[i].xMin,
                                        hsets.values()[0].values()[0].bins[i].xMax)
        elif(type(hsets.values()[0].values()[0])==yoda.core.Histo1D) :
            outhistos[hpath] = yoda.core.Histo1D(hsets.values()[0].values()[0].path,
                                                hsets.values()[0].values()[0].title)
            for i in range(0,hsets.values()[0].values()[0].numBins) :
                outhistos[hpath].addBin(hsets.values()[0].values()[0].bins[i].xMin,
                                        hsets.values()[0].values()[0].bins[i].xMax)
        else :
            logging.error("Histogram %s is of unknown type" % hpath)
            sys.exit(1) 

## Make empty output histos if needed
for hpath,hsets in inhistos_mass.iteritems():
    if(hpath.find("1268975")>0) :
        if(type(hsets.values()[0].values()[0])==yoda.core.Scatter2D) :
            outhistos[hpath] = yoda.core.Scatter2D(hsets.values()[0].values()[0].path,
                                                   hsets.values()[0].values()[0].title)
        elif(type(hsets.values()[0].values()[0])==yoda.core.Profile1D) :
            outhistos[hpath] = yoda.core.Profile1D(hsets.values()[0].values()[0].path,
                                                   hsets.values()[0].values()[0].title)
            for i in range(0,hsets.values()[0].values()[0].numBins) :
                outhistos[hpath].addBin(hsets.values()[0].values()[0].bins[i].xMin,
                                        hsets.values()[0].values()[0].bins[i].xMax)
        elif(type(hsets.values()[0].values()[0])==yoda.core.Histo1D) :
            outhistos[hpath] = yoda.core.Histo1D(hsets.values()[0].values()[0].path,
                                                hsets.values()[0].values()[0].title)
            for i in range(0,hsets.values()[0].values()[0].numBins) :
                outhistos[hpath].addBin(hsets.values()[0].values()[0].bins[i].xMin,
                                        hsets.values()[0].values()[0].bins[i].xMax)
        else :
            logging.error("Histogram %s is of unknown type" % hpath)
            sys.exit(1)
        

logging.info("Processing CMS_2011_S8957746")
useOnePt("/CMS_2011_S8957746/d01-x01-y01", "7000", "80" )
useOnePt("/CMS_2011_S8957746/d02-x01-y01", "7000", "80" )
useOnePt("/CMS_2011_S8957746/d03-x01-y01", "7000", "110" )
useOnePt("/CMS_2011_S8957746/d04-x01-y01", "7000", "110" )
useOnePt("/CMS_2011_S8957746/d05-x01-y01", "7000", "210" )
useOnePt("/CMS_2011_S8957746/d06-x01-y01", "7000", "210" )

logging.info("Processing ATLAS_2010_S8894728")
useOnePt("/ATLAS_2010_S8894728/d01-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d01-x01-y02",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d01-x01-y03",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d02-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d02-x01-y02", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d02-x01-y03", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d03-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d03-x01-y02",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d03-x01-y03",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d04-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d04-x01-y02", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d04-x01-y03", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d05-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d06-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d07-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d08-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d09-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d09-x01-y02",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d09-x01-y03",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d10-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d10-x01-y02", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d10-x01-y03", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d11-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d11-x01-y02",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d11-x01-y03",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d12-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d12-x01-y02", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d12-x01-y03", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d13-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d13-x01-y02",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d13-x01-y03",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d13-x01-y04",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d14-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d14-x01-y02", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d14-x01-y03", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d14-x01-y04", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d15-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d15-x01-y02",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d15-x01-y03",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d15-x01-y04",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d16-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d16-x01-y02", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d16-x01-y03", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d16-x01-y04", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d17-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d17-x01-y02",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d17-x01-y03",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d18-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d18-x01-y02", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d18-x01-y03", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d19-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d19-x01-y02",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d19-x01-y03",  "900", "0" )
useOnePt("/ATLAS_2010_S8894728/d20-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d20-x01-y02", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d20-x01-y03", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d21-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8894728/d22-x01-y01", "7000", "0" )

logging.info("Processing ATLAS_2011_S8994773")
useOnePt("/ATLAS_2011_S8994773/d01-x01-y01", "900", "0" )
useOnePt("/ATLAS_2011_S8994773/d02-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2011_S8994773/d03-x01-y01", "900", "0" )
useOnePt("/ATLAS_2011_S8994773/d04-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2011_S8994773/d13-x01-y01", "900", "0" )
useOnePt("/ATLAS_2011_S8994773/d13-x01-y02", "900", "0" )
useOnePt("/ATLAS_2011_S8994773/d13-x01-y03", "900", "0" )
useOnePt("/ATLAS_2011_S8994773/d14-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2011_S8994773/d14-x01-y02", "7000", "0" )
useOnePt("/ATLAS_2011_S8994773/d14-x01-y03", "7000", "0" )

logging.info("Processing ALICE_2010_S8624100")
useOnePt("/ALICE_2010_S8624100/d11-x01-y01", "900", "0" )
useOnePt("/ALICE_2010_S8624100/d12-x01-y01", "900", "0" )
useOnePt("/ALICE_2010_S8624100/d13-x01-y01", "900", "0" )
useOnePt("/ALICE_2010_S8624100/d17-x01-y01","2360", "0" )
useOnePt("/ALICE_2010_S8624100/d18-x01-y01","2360", "0" )
useOnePt("/ALICE_2010_S8624100/d19-x01-y01","2360", "0" )

logging.info("Processing ALICE_2010_S8625980")
useOnePt("/ALICE_2010_S8625980/d03-x01-y01", "7000", "0" )
useOnePt("/ALICE_2010_S8625980/d04-x01-y01",  "900", "0" )
useOnePt("/ALICE_2010_S8625980/d05-x01-y01", "2360", "0" )
useOnePt("/ALICE_2010_S8625980/d06-x01-y01", "7000", "0" )

logging.info("Processing ATLAS_2010_S8918562")
useOnePt("/ATLAS_2010_S8918562/d01-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d02-x01-y01", "2360", "0" )
useOnePt("/ATLAS_2010_S8918562/d03-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d04-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d05-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d06-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d07-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d08-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d09-x01-y01", "2360", "0" )
useOnePt("/ATLAS_2010_S8918562/d10-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d11-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d12-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d13-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d14-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d15-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d16-x01-y01", "2360", "0" )
useOnePt("/ATLAS_2010_S8918562/d17-x01-y01", "7000", "0" )


useOnePt("/ATLAS_2010_S8918562/d18-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d19-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d20-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d21-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d22-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d23-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d24-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d25-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d26-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d27-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d28-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d29-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d30-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d31-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d32-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d33-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d34-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d35-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d36-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d37-x01-y01", "7000", "0" )
useOnePt("/ATLAS_2010_S8918562/d38-x01-y01",  "900", "0" )
useOnePt("/ATLAS_2010_S8918562/d39-x01-y01", "7000", "0" )



logging.info("Processing ATLAS_2011_S8971293")
useOnePt("/ATLAS_2011_S8971293/d01-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8971293/d01-x01-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8971293/d01-x01-y03", "7000", "210" )
useOnePt("/ATLAS_2011_S8971293/d01-x01-y04", "7000", "260" )
useOnePt("/ATLAS_2011_S8971293/d01-x01-y05", "7000", "260" )
useOnePt("/ATLAS_2011_S8971293/d01-x01-y06", "7000", "400" )
useOnePt("/ATLAS_2011_S8971293/d01-x01-y07", "7000", "400" )
useOnePt("/ATLAS_2011_S8971293/d01-x01-y08", "7000", "600" )
useOnePt("/ATLAS_2011_S8971293/d01-x01-y09", "7000", "600" )
logging.info("Processing ATLAS_2011_S8924791")
useOnePt("/ATLAS_2011_S8924791/d01-x01-y01", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d01-x01-y02", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d01-x02-y01", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d01-x02-y02", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d01-x03-y01", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d01-x03-y02", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d01-x04-y01", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d01-x04-y02", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d01-x05-y01", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d01-x05-y02", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d01-x06-y01", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d01-x06-y02", "7000", "30" )
useOnePt("/ATLAS_2011_S8924791/d02-x01-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d02-x01-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d02-x02-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d02-x02-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d02-x03-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d02-x03-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d02-x04-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d02-x04-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d02-x05-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d02-x05-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d02-x06-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d02-x06-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x01-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x01-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x02-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x02-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x03-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x03-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x04-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x04-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x05-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x05-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x06-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d03-x06-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S8924791/d04-x01-y01", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d04-x01-y02", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d04-x02-y01", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d04-x02-y02", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d04-x03-y01", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d04-x03-y02", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d04-x04-y01", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d04-x04-y02", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d04-x05-y01", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d04-x05-y02", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d04-x06-y01", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d04-x06-y02", "7000", "80" )
useOnePt("/ATLAS_2011_S8924791/d05-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d05-x01-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d05-x02-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d05-x02-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d05-x03-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d05-x03-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d05-x04-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d05-x04-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d05-x05-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d05-x05-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d05-x06-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d05-x06-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x01-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x02-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x02-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x03-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x03-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x04-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x04-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x05-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x05-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x06-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d06-x06-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S8924791/d07-x01-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d07-x01-y02", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d07-x02-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d07-x02-y02", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d07-x03-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d07-x03-y02", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d07-x04-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d07-x04-y02", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d07-x05-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d07-x05-y02", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d07-x06-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d07-x06-y02", "7000", "210" )
useOnePt("/ATLAS_2011_S8924791/d08-x01-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d08-x01-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d08-x02-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d08-x02-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d08-x03-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d08-x03-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d08-x04-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d08-x04-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d08-x05-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d08-x05-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d08-x06-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d08-x06-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x01-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x01-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x02-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x02-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x03-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x03-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x04-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x04-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x05-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x05-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x06-y01", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d09-x06-y02", "7000", "260" )
useOnePt("/ATLAS_2011_S8924791/d10-x01-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d10-x01-y02", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d10-x02-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d10-x02-y02", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d10-x03-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d10-x03-y02", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d10-x04-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d10-x04-y02", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d10-x05-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d10-x05-y02", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d10-x06-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d10-x06-y02", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x01-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x01-y02", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x02-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x02-y02", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x03-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x03-y02", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x04-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x04-y02", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x05-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x05-y02", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x06-y01", "7000", "400" )
useOnePt("/ATLAS_2011_S8924791/d11-x06-y02", "7000", "400" )
logging.info("Processing ATLAS_2010_S8817804")
mergeByPt("/ATLAS_2010_S8817804/d01-x01-y01", "7000")
mergeByPt("/ATLAS_2010_S8817804/d02-x01-y01", "7000")
mergeByPt("/ATLAS_2010_S8817804/d03-x01-y01", "7000")
mergeByPt("/ATLAS_2010_S8817804/d04-x01-y01", "7000")
mergeByPt("/ATLAS_2010_S8817804/d05-x01-y01", "7000")
mergeByPt("/ATLAS_2010_S8817804/d06-x01-y01", "7000")
mergeByPt("/ATLAS_2010_S8817804/d07-x01-y01", "7000")
mergeByPt("/ATLAS_2010_S8817804/d08-x01-y01", "7000")
mergeByPt("/ATLAS_2010_S8817804/d09-x01-y01", "7000")
mergeByPt("/ATLAS_2010_S8817804/d10-x01-y01", "7000")

mergeByMass("/ATLAS_2010_S8817804/d11-x01-y01", "7000")
mergeByMass("/ATLAS_2010_S8817804/d12-x01-y01", "7000")
mergeByMass("/ATLAS_2010_S8817804/d13-x01-y01", "7000")
mergeByMass("/ATLAS_2010_S8817804/d14-x01-y01", "7000")
mergeByMass("/ATLAS_2010_S8817804/d15-x01-y01", "7000")
mergeByMass("/ATLAS_2010_S8817804/d16-x01-y01", "7000")
mergeByMass("/ATLAS_2010_S8817804/d17-x01-y01", "7000")
mergeByMass("/ATLAS_2010_S8817804/d18-x01-y01", "7000")
mergeByMass("/ATLAS_2010_S8817804/d19-x01-y01", "7000")
mergeByMass("/ATLAS_2010_S8817804/d20-x01-y01", "7000")

useOneMass("/ATLAS_2010_S8817804/d21-x01-y01", "7000", "300" )
useOneMass("/ATLAS_2010_S8817804/d22-x01-y01", "7000", "300" )
useOneMass("/ATLAS_2010_S8817804/d23-x01-y01", "7000", "800" )
useOneMass("/ATLAS_2010_S8817804/d24-x01-y01", "7000", "300" )
useOneMass("/ATLAS_2010_S8817804/d25-x01-y01", "7000", "300" )
useOneMass("/ATLAS_2010_S8817804/d26-x01-y01", "7000", "800" )


logging.info("Processing ATLAS_2011_I930220")
mergeByPt("/ATLAS_2011_I930220/d01-x01-y01",  "7000" )
mergeByPt("/ATLAS_2011_I930220/d02-x01-y01",  "7000" )
mergeByPt("/ATLAS_2011_I930220/d03-x01-y01",  "7000" )
mergeByPt("/ATLAS_2011_I930220/d04-x01-y01",  "7000" )
mergeByPt("/ATLAS_2011_I930220/d05-x01-y01",  "7000" )
mergeByPt("/ATLAS_2011_I930220/d06-x01-y01",  "7000" )
mergeByMass("/ATLAS_2011_I930220/d07-x01-y01", "7000")
useOneMass("/ATLAS_2011_I930220/d08-x01-y01", "7000", "110" )
useOneMass("/ATLAS_2011_I930220/d09-x01-y01", "7000", "110" )
useOneMass("/ATLAS_2011_I930220/d10-x01-y01", "7000", "370" )

logging.info("Processing ATLAS_2012_I1082936")
mergeByPt("/ATLAS_2012_I1082936/d01-x01-y01", "7000")
mergeByPt("/ATLAS_2012_I1082936/d01-x01-y02", "7000")
mergeByPt("/ATLAS_2012_I1082936/d01-x01-y03", "7000")
mergeByPt("/ATLAS_2012_I1082936/d01-x01-y04", "7000")
mergeByPt("/ATLAS_2012_I1082936/d01-x01-y05", "7000")
mergeByPt("/ATLAS_2012_I1082936/d01-x01-y06", "7000")
mergeByPt("/ATLAS_2012_I1082936/d01-x01-y07", "7000")
mergeByPt("/ATLAS_2012_I1082936/d02-x01-y01", "7000")
mergeByPt("/ATLAS_2012_I1082936/d02-x01-y02", "7000")
mergeByPt("/ATLAS_2012_I1082936/d02-x01-y03", "7000")
mergeByPt("/ATLAS_2012_I1082936/d02-x01-y04", "7000")
mergeByPt("/ATLAS_2012_I1082936/d02-x01-y05", "7000")
mergeByPt("/ATLAS_2012_I1082936/d02-x01-y06", "7000")
mergeByPt("/ATLAS_2012_I1082936/d02-x01-y07", "7000")

mergeByMass("/ATLAS_2012_I1082936/d03-x01-y01", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d03-x01-y02", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d03-x01-y03", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d03-x01-y04", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d03-x01-y05", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d03-x01-y06", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d03-x01-y07", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d03-x01-y08", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d03-x01-y09", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d04-x01-y01", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d04-x01-y02", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d04-x01-y03", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d04-x01-y04", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d04-x01-y05", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d04-x01-y06", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d04-x01-y07", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d04-x01-y08", "7000", 1000.)
mergeByMass("/ATLAS_2012_I1082936/d04-x01-y09", "7000", 1000.)


logging.info("Processing CMS_2011_S8968497")

useOneMass("/CMS_2011_S8968497/d01-x01-y01", "7000", "2000" )
useOneMass("/CMS_2011_S8968497/d02-x01-y01", "7000", "1200" )
useOneMass("/CMS_2011_S8968497/d03-x01-y01", "7000", "1200" )
useOneMass("/CMS_2011_S8968497/d04-x01-y01", "7000", "800" )
useOneMass("/CMS_2011_S8968497/d05-x01-y01", "7000", "800" )
useOneMass("/CMS_2011_S8968497/d06-x01-y01", "7000", "300" )
useOneMass("/CMS_2011_S8968497/d07-x01-y01", "7000", "300" )
useOneMass("/CMS_2011_S8968497/d08-x01-y01", "7000", "300" )
useOneMass("/CMS_2011_S8968497/d09-x01-y01", "7000", "100" )


logging.info("Processing ATLAS_2011_S9126244")
mergeByPt("/ATLAS_2011_S9126244/d01-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9126244/d01-x01-y02", "7000")
mergeByPt("/ATLAS_2011_S9126244/d02-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9126244/d02-x01-y02", "7000")
mergeByPt("/ATLAS_2011_S9126244/d03-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9126244/d03-x01-y02", "7000")
mergeByPt("/ATLAS_2011_S9126244/d04-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9126244/d04-x01-y02", "7000")
mergeByPt("/ATLAS_2011_S9126244/d05-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9126244/d05-x01-y02", "7000")


useOnePt("/ATLAS_2011_S9126244/d06-x01-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S9126244/d06-x01-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S9126244/d07-x01-y01", "7000", "80" )
useOnePt("/ATLAS_2011_S9126244/d07-x01-y02", "7000", "80" )
useOnePt("/ATLAS_2011_S9126244/d08-x01-y01", "7000", "80" )
useOnePt("/ATLAS_2011_S9126244/d08-x01-y02", "7000", "80" )
useOnePt("/ATLAS_2011_S9126244/d09-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d09-x01-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d10-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d10-x01-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d11-x01-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d11-x01-y02", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d12-x01-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d12-x01-y02", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d13-x01-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S9126244/d13-x01-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S9126244/d14-x01-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S9126244/d14-x01-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S9126244/d15-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d15-x01-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d16-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d16-x01-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d17-x01-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d17-x01-y02", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d18-x01-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d18-x01-y02", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d19-x01-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S9126244/d20-x01-y01", "7000", "80" )
useOnePt("/ATLAS_2011_S9126244/d21-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d22-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d23-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d24-x01-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d25-x01-y01", "7000", "210" )
mergeByPt("/ATLAS_2011_S9126244/d26-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9126244/d26-x01-y02", "7000")
mergeByPt("/ATLAS_2011_S9126244/d27-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9126244/d27-x01-y02", "7000")
mergeByPt("/ATLAS_2011_S9126244/d28-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9126244/d28-x01-y02", "7000")
mergeByPt("/ATLAS_2011_S9126244/d29-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9126244/d29-x01-y02", "7000")
useOnePt("/ATLAS_2011_S9126244/d30-x01-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S9126244/d31-x01-y01", "7000", "80" )
useOnePt("/ATLAS_2011_S9126244/d32-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d33-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d34-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d35-x01-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d36-x01-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d37-x01-y01", "7000", "40" )
useOnePt("/ATLAS_2011_S9126244/d37-x01-y02", "7000", "40" )
useOnePt("/ATLAS_2011_S9126244/d38-x01-y01", "7000", "80" )
useOnePt("/ATLAS_2011_S9126244/d38-x01-y02", "7000", "80" )
useOnePt("/ATLAS_2011_S9126244/d39-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d39-x01-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d40-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d40-x01-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d41-x01-y01", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d41-x01-y02", "7000", "110" )
useOnePt("/ATLAS_2011_S9126244/d42-x01-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d42-x01-y02", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d43-x01-y01", "7000", "210" )
useOnePt("/ATLAS_2011_S9126244/d43-x01-y02", "7000", "210" )

# CMS_2011_S9120041 UE analysis
logging.info("Processing CMS_2011_S9120041")
mergeByPt("/CMS_2011_S9120041/d01-x01-y01", "7000")
mergeByPt("/CMS_2011_S9120041/d02-x01-y01", "7000")
if(opts.ue) :
    useOnePt("/CMS_2011_S9120041/d03-x01-y01",  "900", "0" )
    useOnePt("/CMS_2011_S9120041/d04-x01-y01",  "900", "0" )
    useOnePt("/CMS_2011_S9120041/d05-x01-y01", "7000", "0" )
    useOnePt("/CMS_2011_S9120041/d06-x01-y01", "7000", "0" )
    useOnePt("/CMS_2011_S9120041/d07-x01-y01", "7000", "0" )
    useOnePt("/CMS_2011_S9120041/d11-x01-y01",  "900", "0" )
    useOnePt("/CMS_2011_S9120041/d12-x01-y01",  "900", "0" )
    useOnePt("/CMS_2011_S9120041/d13-x01-y01",  "900", "0" )
    useOnePt("/CMS_2011_S9120041/d08-x01-y01", "7000", "20" )
    useOnePt("/CMS_2011_S9120041/d09-x01-y01", "7000", "20" )
    useOnePt("/CMS_2011_S9120041/d10-x01-y01", "7000", "20" )
else :
    useOnePt("/CMS_2011_S9120041/d08-x01-y01", "7000", "10" )
    useOnePt("/CMS_2011_S9120041/d09-x01-y01", "7000", "10" )
    useOnePt("/CMS_2011_S9120041/d10-x01-y01", "7000", "10" )

# CMS dijet decorrelation
logging.info("Processing CMS_2011_S8950903")
useOnePt("/CMS_2011_S8950903/d01-x01-y01", "7000", "80" )
useOnePt("/CMS_2011_S8950903/d02-x01-y01", "7000", "110" )
useOnePt("/CMS_2011_S8950903/d03-x01-y01", "7000", "110" )
useOnePt("/CMS_2011_S8950903/d04-x01-y01", "7000", "210" )
useOnePt("/CMS_2011_S8950903/d05-x01-y01", "7000", "260" )

# CMS jet cross section
logging.info("Processing CMS_2011_S9086218")
mergeByPt("/CMS_2011_S9086218/d01-x01-y01", "7000")
mergeByPt("/CMS_2011_S9086218/d02-x01-y01", "7000")
mergeByPt("/CMS_2011_S9086218/d03-x01-y01", "7000")
mergeByPt("/CMS_2011_S9086218/d04-x01-y01", "7000")
mergeByPt("/CMS_2011_S9086218/d05-x01-y01", "7000")
mergeByPt("/CMS_2011_S9086218/d06-x01-y01", "7000")

# CMS 2/3 jet cross section ratio
logging.info("Processing CMS_2011_S9086218")
mergeByPt("/CMS_2011_S9088458/d01-x01-y01", "7000",500.)

# ATLAS track jet
logging.info("Processing ATLAS_2011_I919017")
for d in range(1,3) :
    for y in range(1,5) :
        mergeByPt("/ATLAS_2011_I919017/d0%s-x01-y0%s" % (d,y), "7000")
        if( opts.ue) :
            for x in range(2,6) :
                for y in ["01","02","06","07","11","12","16","17","21","22"] :
                    useOnePt("/ATLAS_2011_I919017/d01-x0%s-y%s" % (x,y),  "7000",  "0" )
                for y in ["03","04","08","09","13","14","18","19","23","24"] :
                    useOnePt("/ATLAS_2011_I919017/d01-x0%s-y%s" % (x,y),  "7000",  "4" )
            for y in range(5,30,5) :
                if(y < 10) :
                    useOnePt("/ATLAS_2011_I919017/d01-x0%s-y0%s" % (x,y) ,  "7000", "20" )
                else :
                    useOnePt("/ATLAS_2011_I919017/d01-x0%s-y%s"  % (x,y) ,  "7000", "20" )
        else :
            for x in range(2,6) :
                for y in range(5,30,5) :
                    if(y < 10) :
                        useOnePt("/ATLAS_2011_I919017/d01-x0%s-y0%s" % (x,y) ,  "7000", "10" )
                    else :
                        useOnePt("/ATLAS_2011_I919017/d01-x0%s-y%s"  % (x,y) ,  "7000", "10" )

logging.info("Processing ATLAS_2011_I926145")
mergeByPt("/ATLAS_2011_I926145/d01-x01-y01", "7000",1.5)
mergeByPt("/ATLAS_2011_I926145/d02-x01-y01", "7000",1.5)
mergeByPt("/ATLAS_2011_I926145/d03-x01-y01", "7000",1.5)

logging.info("Processing CMS_2011_S8941262")
useOnePt("/CMS_2011_S8941262/d01-x01-y01",  "7000", "10" )
useOnePt("/CMS_2011_S8941262/d03-x01-y01",  "7000", "10" )
mergeByPt("/CMS_2011_S8941262/d02-x01-y01", "7000",1.5)

logging.info("Processing CMS_2011_S8973270")
useOnePt("/CMS_2011_S8973270/d01-x01-y01",  "7000", "70" )
useOnePt("/CMS_2011_S8973270/d02-x01-y01",  "7000", "100" )
useOnePt("/CMS_2011_S8973270/d03-x01-y01",  "7000", "130" )
useOnePt("/CMS_2011_S8973270/d04-x01-y01",  "7000", "70" )
useOnePt("/CMS_2011_S8973270/d05-x01-y01",  "7000", "100" )
useOnePt("/CMS_2011_S8973270/d06-x01-y01",  "7000", "130" )

logging.info("Processing ATLAS_2012_I1082009")
useOnePt("/ATLAS_2012_I1082009/d08-x01-y01", "7000", "40" )
useOnePt("/ATLAS_2012_I1082009/d09-x01-y01", "7000", "40" )
useOnePt("/ATLAS_2012_I1082009/d10-x01-y01", "7000", "40" )
useOnePt("/ATLAS_2012_I1082009/d11-x01-y01", "7000", "80" )
useOnePt("/ATLAS_2012_I1082009/d12-x01-y01", "7000", "80" )
useOnePt("/ATLAS_2012_I1082009/d13-x01-y01", "7000", "40" )

logging.info("Processing ATLAS_2012_I1118269")
mergeByPt("/ATLAS_2012_I1118269/d01-x01-y01", "7000")
useOnePt("/ATLAS_2012_I1118269/d02-x01-y01", "7000", "10" )

logging.info("Processing ATLAS_2012_I1188891")
mergeByPt("/ATLAS_2012_I1188891/d01-x01-y01", "7000")
mergeByPt("/ATLAS_2012_I1188891/d02-x01-y01", "7000")
mergeByPt("/ATLAS_2012_I1188891/d03-x01-y01", "7000")
mergeByPt("/ATLAS_2012_I1188891/d04-x01-y01", "7000")
mergeByPt("/ATLAS_2012_I1188891/d05-x01-y01", "7000")
mergeByPt("/ATLAS_2012_I1188891/d06-x01-y01", "7000")

logging.info("Processing CMS_2012_I1087342")
mergeByPt("/CMS_2012_I1087342/d01-x01-y01", "7000")
mergeByPt("/CMS_2012_I1087342/d02-x01-y01", "7000")
mergeByPt("/CMS_2012_I1087342/d03-x01-y01", "7000")
logging.info("Processing CMS_2012_PAS_QCD_11_010")
mergeByPt("/CMS_2012_PAS_QCD_11_010/d01-x01-y01", "7000")
mergeByPt("/CMS_2012_PAS_QCD_11_010/d02-x01-y01", "7000")
mergeByPt("/CMS_2012_PAS_QCD_11_010/d03-x01-y01", "7000")
mergeByPt("/CMS_2012_PAS_QCD_11_010/d04-x01-y01", "7000")

logging.info("Processing ATLAS_2011_S9035664")
mergeByPt("/ATLAS_2011_S9035664/d11-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9035664/d12-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9035664/d13-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9035664/d14-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9035664/d15-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9035664/d16-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9035664/d17-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9035664/d18-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9035664/d20-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9035664/d21-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9035664/d22-x01-y01", "7000")
mergeByPt("/ATLAS_2011_S9035664/d23-x01-y01", "7000")

logging.info("Processing ATLAS_2012_I1125575")
mergeByPt("/ATLAS_2012_I1125575/d01-x01-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d01-x01-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d01-x02-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d01-x02-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d01-x03-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d01-x03-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d01-x04-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d01-x04-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d01-x05-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d01-x05-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d02-x01-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d02-x01-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d02-x02-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d02-x02-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d02-x03-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d02-x03-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d02-x04-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d02-x04-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d02-x05-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d02-x05-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d03-x01-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d03-x01-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d03-x02-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d03-x02-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d03-x03-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d03-x03-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d03-x04-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d03-x04-y02", "7000")
mergeByPt("/ATLAS_2012_I1125575/d03-x05-y01", "7000")
mergeByPt("/ATLAS_2012_I1125575/d03-x05-y02", "7000")
for d in range(4,7) :
    for x in range(1,6) :
        if(opts.ue) :
            for y in range(1,9) :
                useOnePt("/ATLAS_2012_I1125575/d0%s-x0%s-y0%s" % (d,x,y),  "7000", "0" )
            for y in ["09","10","11","12","13","14","15","16"] :
                useOnePt("/ATLAS_2012_I1125575/d0%s-x0%s-y%s" % (d,x,y),  "7000", "0" )
            for y in range(17,19) :
                useOnePt("/ATLAS_2012_I1125575/d0%s-x0%s-y%s" % (d,x,y),  "7000", "20" )
        else :
            for y in range(17,19) :
                useOnePt("/ATLAS_2012_I1125575/d0%s-x0%s-y%s" % (d,x,y),  "7000", "10" )
        for y in range(19,21) :
            useOnePt("/ATLAS_2012_I1125575/d0%s-x0%s-y%s" % (d,x,y),  "7000", "40" )

# ATLAS_2012_I1094564
useOnePt("/ATLAS_2012_I1094564/d01-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2012_I1094564/d02-x01-y01",  "7000", "260" )
useOnePt("/ATLAS_2012_I1094564/d03-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d04-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d05-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2012_I1094564/d06-x01-y01",  "7000", "260" )
useOnePt("/ATLAS_2012_I1094564/d07-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d08-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d09-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2012_I1094564/d10-x01-y01",  "7000", "260" )
useOnePt("/ATLAS_2012_I1094564/d11-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d12-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d13-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2012_I1094564/d14-x01-y01",  "7000", "260" )
useOnePt("/ATLAS_2012_I1094564/d15-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d16-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d17-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2012_I1094564/d18-x01-y01",  "7000", "260" )
useOnePt("/ATLAS_2012_I1094564/d19-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d20-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d21-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2012_I1094564/d22-x01-y01",  "7000", "260" )
useOnePt("/ATLAS_2012_I1094564/d23-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d24-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d25-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2012_I1094564/d26-x01-y01",  "7000", "260" )
useOnePt("/ATLAS_2012_I1094564/d27-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d28-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d29-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2012_I1094564/d30-x01-y01",  "7000", "260" )
useOnePt("/ATLAS_2012_I1094564/d31-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d32-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d33-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2012_I1094564/d34-x01-y01",  "7000", "260" )
useOnePt("/ATLAS_2012_I1094564/d35-x01-y01",  "7000", "400" )
useOnePt("/ATLAS_2012_I1094564/d36-x01-y01",  "7000", "400" )

logging.info("Processing CMS_2013_I1224539_DIJET")
useOnePt("/CMS_2013_I1224539_DIJET/d01-x01-y01",  "7000", "210" )
useOnePt("/CMS_2013_I1224539_DIJET/d02-x01-y01",  "7000", "260" )
useOnePt("/CMS_2013_I1224539_DIJET/d03-x01-y01",  "7000", "400" )
useOnePt("/CMS_2013_I1224539_DIJET/d04-x01-y01",  "7000", "400" )
useOnePt("/CMS_2013_I1224539_DIJET/d05-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d06-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d07-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d08-x01-y01",  "7000", "210" )
useOnePt("/CMS_2013_I1224539_DIJET/d09-x01-y01",  "7000", "260" )
useOnePt("/CMS_2013_I1224539_DIJET/d10-x01-y01",  "7000", "400" )
useOnePt("/CMS_2013_I1224539_DIJET/d11-x01-y01",  "7000", "400" )
useOnePt("/CMS_2013_I1224539_DIJET/d12-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d13-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d14-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d15-x01-y01",  "7000", "210" )
useOnePt("/CMS_2013_I1224539_DIJET/d16-x01-y01",  "7000", "260" )
useOnePt("/CMS_2013_I1224539_DIJET/d17-x01-y01",  "7000", "400" )
useOnePt("/CMS_2013_I1224539_DIJET/d18-x01-y01",  "7000", "400" )
useOnePt("/CMS_2013_I1224539_DIJET/d19-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d20-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d21-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d22-x01-y01",  "7000", "210" )
useOnePt("/CMS_2013_I1224539_DIJET/d23-x01-y01",  "7000", "260" )
useOnePt("/CMS_2013_I1224539_DIJET/d24-x01-y01",  "7000", "400" )
useOnePt("/CMS_2013_I1224539_DIJET/d25-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d26-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d27-x01-y01",  "7000", "600" )
useOnePt("/CMS_2013_I1224539_DIJET/d28-x01-y01",  "7000", "600" )

useOnePt("/CMS_2013_I1273574/d01-x01-y01",  "7000", "80" )
mergeByPt("/CMS_2013_I1273574/d02-x01-y01", "7000",1.)
useOnePt("/CMS_2013_I1273574/d03-x01-y01",  "7000", "80" )
useOnePt("/CMS_2013_I1273574/d04-x01-y01",  "7000", "80" )
useOnePt("/CMS_2013_I1273574/d05-x01-y01",  "7000", "80" )
useOnePt("/CMS_2013_I1273574/d06-x01-y01",  "7000", "80" )
mergeByPt("/CMS_2013_I1273574/d07-x01-y01", "7000",1.)
useOnePt("/CMS_2013_I1273574/d08-x01-y01",  "7000", "80" )
mergeByPt("/CMS_2013_I1273574/d09-x01-y01", "7000",1.)
useOnePt("/CMS_2013_I1273574/d10-x01-y01",  "7000", "80" )
mergeByPt("/CMS_2013_I1273574/d11-x01-y01", "7000",1.)

useOnePt("/CMS_2013_I1261026/d01-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d02-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d03-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d04-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d05-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d06-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d07-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d08-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d09-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d10-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d11-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d12-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d13-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d14-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d15-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d16-x01-y01",  "7000", "0" )
useOnePt("/CMS_2013_I1261026/d17-x01-y01",  "7000", "0" )


useOneMass("/CMS_2012_I1090423/d01-x01-y01", "7000", "2000" )
useOneMass("/CMS_2012_I1090423/d02-x01-y01", "7000", "2000" )
useOneMass("/CMS_2012_I1090423/d03-x01-y01", "7000", "1200" )
useOneMass("/CMS_2012_I1090423/d04-x01-y01", "7000", "1200" )
useOneMass("/CMS_2012_I1090423/d05-x01-y01", "7000", "1200" )
useOneMass("/CMS_2012_I1090423/d06-x01-y01", "7000", "800" )
useOneMass("/CMS_2012_I1090423/d07-x01-y01", "7000", "800" )
useOneMass("/CMS_2012_I1090423/d08-x01-y01", "7000", "300" )
useOneMass("/CMS_2012_I1090423/d09-x01-y01", "7000", "300" )

logging.info("Processing ATLAS_2014_I1298811")
mergeByPt("/ATLAS_2014_I1298811/d01-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1298811/d01-x01-y02", "7000")
mergeByPt("/ATLAS_2014_I1298811/d02-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1298811/d02-x01-y02", "7000")
mergeByPt("/ATLAS_2014_I1298811/d03-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1298811/d03-x01-y02", "7000")
mergeByPt("/ATLAS_2014_I1298811/d04-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1298811/d04-x01-y02", "7000")
mergeByPt("/ATLAS_2014_I1298811/d05-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1298811/d05-x01-y02", "7000")
mergeByPt("/ATLAS_2014_I1298811/d06-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1298811/d06-x01-y02", "7000")
mergeByPt("/ATLAS_2014_I1298811/d07-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1298811/d07-x01-y02", "7000")
mergeByPt("/ATLAS_2014_I1298811/d08-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1298811/d08-x01-y02", "7000")
mergeByPt("/ATLAS_2014_I1298811/d09-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1298811/d09-x01-y02", "7000")
mergeByPt("/ATLAS_2014_I1298811/d10-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1298811/d10-x01-y02", "7000")
useOnePt("/ATLAS_2014_I1298811/d11-x01-y01",  "7000", "0" )
useOnePt("/ATLAS_2014_I1298811/d12-x01-y01",  "7000", "0" )

useOnePt("/ATLAS_2014_I1298811/d13-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d13-x01-y02",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d14-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d14-x01-y02",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d15-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d15-x01-y02",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d25-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d25-x01-y02",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d26-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d26-x01-y02",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d27-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d27-x01-y02",  "7000", "4" )

useOnePt("/ATLAS_2014_I1298811/d16-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d16-x01-y02",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d17-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d17-x01-y02",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d18-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d18-x01-y02",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d28-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d28-x01-y02",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d29-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d29-x01-y02",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d30-x01-y01",  "7000", "4" )
useOnePt("/ATLAS_2014_I1298811/d30-x01-y02",  "7000", "4" )

useOnePt("/ATLAS_2014_I1298811/d19-x01-y01",  "7000", "40" )
useOnePt("/ATLAS_2014_I1298811/d19-x01-y02",  "7000", "40" )
useOnePt("/ATLAS_2014_I1298811/d20-x01-y01",  "7000", "40" )
useOnePt("/ATLAS_2014_I1298811/d20-x01-y02",  "7000", "40" )
useOnePt("/ATLAS_2014_I1298811/d21-x01-y01",  "7000", "40" )
useOnePt("/ATLAS_2014_I1298811/d21-x01-y02",  "7000", "40" )
useOnePt("/ATLAS_2014_I1298811/d31-x01-y01",  "7000", "40" )
useOnePt("/ATLAS_2014_I1298811/d31-x01-y02",  "7000", "40" )
useOnePt("/ATLAS_2014_I1298811/d32-x01-y01",  "7000", "40" )
useOnePt("/ATLAS_2014_I1298811/d32-x01-y02",  "7000", "40" )
useOnePt("/ATLAS_2014_I1298811/d33-x01-y01",  "7000", "40" )
useOnePt("/ATLAS_2014_I1298811/d33-x01-y02",  "7000", "40" )

useOnePt("/ATLAS_2014_I1298811/d22-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2014_I1298811/d22-x01-y02",  "7000", "210" )
useOnePt("/ATLAS_2014_I1298811/d23-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2014_I1298811/d23-x01-y02",  "7000", "210" )
useOnePt("/ATLAS_2014_I1298811/d24-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2014_I1298811/d24-x01-y02",  "7000", "210" )
useOnePt("/ATLAS_2014_I1298811/d34-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2014_I1298811/d34-x01-y02",  "7000", "210" )
useOnePt("/ATLAS_2014_I1298811/d35-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2014_I1298811/d35-x01-y02",  "7000", "210" )
useOnePt("/ATLAS_2014_I1298811/d36-x01-y01",  "7000", "210" )
useOnePt("/ATLAS_2014_I1298811/d36-x01-y02",  "7000", "210" )


logging.info("Processing ATLAS_2014_I1268975")
mergeByMass("/ATLAS_2014_I1268975/d01-x01-y01", "7000", 1000.)
mergeByMass("/ATLAS_2014_I1268975/d01-x01-y02", "7000", 1000.)
mergeByMass("/ATLAS_2014_I1268975/d01-x01-y03", "7000", 1000.)
mergeByMass("/ATLAS_2014_I1268975/d01-x01-y04", "7000", 1000.)
mergeByMass("/ATLAS_2014_I1268975/d01-x01-y05", "7000", 1000.)
mergeByMass("/ATLAS_2014_I1268975/d01-x01-y06", "7000", 1000.)

mergeByMass("/ATLAS_2014_I1268975/d02-x01-y01", "7000", 1000.)
mergeByMass("/ATLAS_2014_I1268975/d02-x01-y02", "7000", 1000.)
mergeByMass("/ATLAS_2014_I1268975/d02-x01-y03", "7000", 1000.)
mergeByMass("/ATLAS_2014_I1268975/d02-x01-y04", "7000", 1000.)
mergeByMass("/ATLAS_2014_I1268975/d02-x01-y05", "7000", 1000.)
mergeByMass("/ATLAS_2014_I1268975/d02-x01-y06", "7000", 1000.)

logging.info("Processing ATLAS_2014_I1307243")
useOnePt( "/ATLAS_2014_I1307243/d01-x01-y01",  "7000", "80" )
mergeByPt("/ATLAS_2014_I1307243/d02-x01-y01", "7000")
useOnePt( "/ATLAS_2014_I1307243/d03-x01-y01",  "7000", "80" )
mergeByPt("/ATLAS_2014_I1307243/d04-x01-y01", "7000")
useOnePt( "/ATLAS_2014_I1307243/d05-x01-y01",  "7000", "80" )
mergeByPt("/ATLAS_2014_I1307243/d06-x01-y01", "7000")
useOnePt( "/ATLAS_2014_I1307243/d07-x01-y01",  "7000", "80" )
mergeByPt("/ATLAS_2014_I1307243/d08-x01-y01", "7000")
useOnePt( "/ATLAS_2014_I1307243/d09-x01-y01",  "7000", "80" )
mergeByPt("/ATLAS_2014_I1307243/d10-x01-y01", "7000")
useOnePt( "/ATLAS_2014_I1307243/d11-x01-y01",  "7000", "80" )
mergeByPt("/ATLAS_2014_I1307243/d12-x01-y01", "7000")
useOnePt( "/ATLAS_2014_I1307243/d13-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d14-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d15-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d16-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d17-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d18-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d19-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d20-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d21-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d22-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d23-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d24-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d25-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d26-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d27-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d28-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d29-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d30-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d31-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d32-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d33-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d34-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d35-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d36-x01-y01",  "7000", "80" )
useOnePt( "/ATLAS_2014_I1307243/d37-x01-y01",  "7000", "80" )
mergeByPt("/ATLAS_2014_I1307243/d38-x01-y01", "7000")
useOnePt( "/ATLAS_2014_I1307243/d39-x01-y01",  "7000", "80" )
mergeByPt("/ATLAS_2014_I1307243/d40-x01-y01", "7000")


logging.info("Processing ATLAS_2014_I1325553")
mergeByPt("/ATLAS_2014_I1325553/d01-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1325553/d01-x01-y02", "7000")
mergeByPt("/ATLAS_2014_I1325553/d01-x01-y03", "7000")
mergeByPt("/ATLAS_2014_I1325553/d01-x01-y04", "7000")
mergeByPt("/ATLAS_2014_I1325553/d01-x01-y05", "7000")
mergeByPt("/ATLAS_2014_I1325553/d01-x01-y06", "7000")
mergeByPt("/ATLAS_2014_I1325553/d02-x01-y01", "7000")
mergeByPt("/ATLAS_2014_I1325553/d02-x01-y02", "7000")
mergeByPt("/ATLAS_2014_I1325553/d02-x01-y03", "7000")
mergeByPt("/ATLAS_2014_I1325553/d02-x01-y04", "7000")
mergeByPt("/ATLAS_2014_I1325553/d02-x01-y05", "7000")
mergeByPt("/ATLAS_2014_I1325553/d02-x01-y06", "7000")

logging.info("Processing CMS_2013_I1208923")
for i in range(1,6) :
    mergeByPt  ("/CMS_2013_I1208923/d01-x01-y0%s" % i, "7000")
    mergeByMass("/CMS_2013_I1208923/d02-x01-y0%s" % i, "7000", 1.)

logging.info("Processing CMS_2014_I1298810")
for i in range(1,19) :
    if(i<10) :
        mergeByPt("/CMS_2014_I1298810/d0"+str(i)+"-x01-y01", "7000")
    else :
        mergeByPt("/CMS_2014_I1298810/d"+str(i)+"-x01-y01", "7000")

# Choose output file
name = args[0]+"-Jets.yoda"
yoda.writeYODA(outhistos,name)
sys.exit(0)
