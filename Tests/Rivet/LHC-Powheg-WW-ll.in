##################################################
# Rivet analyses at the Z pole
##################################################
read LHCBase-Powheg.in

##################################################
#  Use the q qbar matrix element
##################################################
cd /Herwig/MatrixElements
# needs the gauge bosons decayed before the shower 
create Herwig::HwDecayHandler /Herwig/NewPhysics/DecayHandler
set /Herwig/NewPhysics/DecayHandler:NewStep No
insert /Herwig/NewPhysics/DecayHandler:Excluded 0 /Herwig/Particles/tau-
insert /Herwig/NewPhysics/DecayHandler:Excluded 1 /Herwig/Particles/tau+
insert /Herwig/EventHandlers/LHCHandler:PreCascadeHandlers 0 /Herwig/NewPhysics/DecayHandler
# Drell-Yan Z/gamma
insert SimpleQCD:MatrixElements[0] PowhegMEPP2VV
set PowhegMEPP2VV:Process WW

do /Herwig/Particles/W+:SelectDecayModes /Herwig/Particles/W+/W+->nu_e,e+; /Herwig/Particles/W+/W+->nu_mu,mu+; /Herwig/Particles/W+/W+->nu_tau,tau+;

# No QED radiation
erase /Herwig/EventHandlers/LHCHandler:PostSubProcessHandlers 0

# put BR's into cross section
create Herwig::BranchingRatioReweighter /Herwig/Generators/BRReweighter
insert /Herwig/EventHandlers/LHCHandler:PostHadronizationHandlers 0 /Herwig/Generators/BRReweighter

##################################################
# select the analyses
##################################################

# general analysis
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 ATLAS_2013_I1190187

##################################################
# Save run for later usage with 'Herwig++ run'
##################################################
cd /Herwig/Generators
saverun LHC-Powheg-WW-ll LHCGenerator
