

cd /Herwig/Partons
create ThePEG::LHAPDF PDFSet ThePEGLHAPDF.so
set PDFSet:RemnantHandler HadronRemnants
set /Herwig/Partons/PDFSet:PDFName MMHT2014nlo68cl
set /Herwig/Particles/p+:PDF PDFSet
set /Herwig/Particles/pbar-:PDF PDFSet

set /Herwig/DipoleShower/Kinematics/FFLightKinematics:IRCutoff  0.78
set /Herwig/DipoleShower/Kinematics/FILightKinematics:IRCutoff  0.78
set /Herwig/DipoleShower/Kinematics/IFLightKinematics:IRCutoff  0.78
set /Herwig/DipoleShower/Kinematics/IILightKinematics:IRCutoff  0.78

set /Herwig/Model:QCD/RunningAlphaS /Herwig/Couplings/NLOAlphaS
set /Herwig/DipoleShower/DipoleShowerHandler:GlobalAlphaS /Herwig/Couplings/NLOAlphaS
set /Herwig/DipoleShower/DipoleShowerHandler:GlobalAlphaS:input_alpha_s 0.118
set /Herwig/Couplings/NLOAlphaS:input_alpha_s 0.118

read Matchbox/FiveFlavourNoBMassScheme.in


cd /Herwig/Particles

set d:NominalMass 0*GeV
set dbar:NominalMass 0*GeV
set u:NominalMass 0*GeV
set ubar:NominalMass 0*GeV
set s:NominalMass 0*GeV
set sbar:NominalMass 0*GeV
set c:NominalMass 0*GeV
set cbar:NominalMass 0*GeV

set c:HardProcessMass 0*GeV
set cbar:HardProcessMass 0*GeV
set b:HardProcessMass 0*GeV
set bbar:HardProcessMass 0*GeV

set e+:HardProcessMass 0*GeV
set e-:HardProcessMass 0*GeV
set mu+:HardProcessMass 0*GeV
set mu-:HardProcessMass 0*GeV

set nu_e:HardProcessMass 0*GeV
set nu_ebar:HardProcessMass 0*GeV
set nu_mu:HardProcessMass 0*GeV
set nu_mubar:HardProcessMass 0*GeV
set nu_tau:HardProcessMass 0*GeV
set nu_taubar:HardProcessMass 0*GeV




cd /Herwig/Cuts
set MassCut:MinM 66*GeV
set MassCut:MaxM 116*GeV
set /Herwig/Generators/LHCGenerator:EventHandler:CollisionCuts Off


cd /Herwig/MatrixElements/Matchbox/Phasespace

set TreePhasespace:M0 0.01*GeV
set TreePhasespace:MC 0.0001*GeV



set /Herwig/Generators/LHCGenerator:MaxErrors 10000
cd /Herwig/EventHandlers

set /Herwig/EventHandlers/LHCHandler:LuminosityFunction:Energy 7000.0*GeV
set /Herwig/Generators/LHCGenerator:NumberOfEvents 100000000
cd /Herwig/Merging
insert /Herwig/Generators/LHCGenerator:EventHandler:SubProcessHandlers[0] PPMFactory


set PPMFactory:QuarkFlavourDiagonal Yes 

set /Herwig/Vertices/FFWMatchboxVertex:Diagonal Yes 



clear PPMFactory:ParticleGroup p
do PPMFactory:StartParticleGroup p
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/g
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/u
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/ubar
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/d
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/dbar
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/s
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/sbar
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/c
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/cbar
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/b
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/bbar
do PPMFactory:EndParticleGroup

clear PPMFactory:ParticleGroup j
do PPMFactory:StartParticleGroup j
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/g
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/u
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/ubar
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/d
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/dbar
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/s
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/sbar
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/c
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/cbar
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/b
insert PPMFactory:ParticleGroup 0 /Herwig/Particles/bbar
do PPMFactory:EndParticleGroup








cd /Herwig/Merging
create Herwig::Merger Merger



create Herwig::MergingReweight MPreWeight HwDipoleShower.so
insert PPMFactory:Preweighters 0  MPreWeight
set MPreWeight:HTPower 2
set MPreWeight:MaxPTPower 0
set MPreWeight:OnlyColoured False

create Herwig::SimpleColourBasis  LargeNColourBasis
set LargeNColourBasis:LargeN On
set Merger:LargeNBasis LargeNColourBasis

set Merger:DipoleShowerHandler /Herwig/DipoleShower/DipoleShowerHandler
set /Herwig/DipoleShower/DipoleShowerHandler:MergingHelper Merger



cd /Herwig/Generators
set LHCGenerator:EventHandler:CascadeHandler /Herwig/DipoleShower/DipoleShowerHandler

set LHCGenerator:EventHandler:CascadeHandler:MPIHandler NULL
set LHCGenerator:EventHandler:MultipleInteractionHandler NULL
set LHCGenerator:EventHandler:DecayHandler NULL
set LHCGenerator:EventHandler:HadronizationHandler NULL
erase /Herwig/Generators/LHCGenerator:EventHandler:PostSubProcessHandlers[0]



create Herwig::MonacoSampler /Herwig/Samplers/Monaco

set /Herwig/Samplers/Sampler:BinSampler /Herwig/Samplers/Monaco
cd /Herwig/MatrixElements/Matchbox/Phasespace

set TreePhasespace:M0 0.01*GeV
set TreePhasespace:MC 0.0001*GeV
set /Herwig/Merging/PPMFactory:Phasespace TreePhasespace


cd /Herwig/EventHandlers


set LHCHandler:Sampler  /Herwig/Samplers/Sampler

cd /Herwig/Samplers


set Monaco:EnhancementFactor 1.2
set Monaco:InitialPoints 200
set Monaco:LuminosityMapperBins 8
set Monaco:NIterations 1
set Monaco:RemapChannelDimension Yes
set Monaco:RemapperMinSelection 0.0001
set Monaco:RemapperPoints 200
set Monaco:UseAllIterations No

set Sampler:UpdateAfter 1000
set Sampler:AddUpSamplers Off
set Sampler:GlobalMaximumWeight Off
set Sampler:FlatSubprocesses Off
set Sampler:MinSelection 0.000001
set Sampler:AlmostUnweighted On
set Sampler:BinSampler:Kappa 0.001
set Sampler:RunCombinationData Off
set Sampler:Verbose On








cd /Herwig/MatrixElements/Matchbox/Amplitudes

#clear /Herwig/Merging/PPMFactory:Amplitudes

#set GenericProcesses:TreeLevelAmplitude MadGraph
#set GenericProcesses:OneLoopAmplitude OpenLoops






cd /Herwig/Cuts
set MassCut:MinM 66*GeV
set MassCut:MaxM 116*GeV

set /Herwig/Generators/LHCGenerator:MaxErrors 10000
cd /Herwig/EventHandlers

set /Herwig/EventHandlers/LHCHandler:LuminosityFunction:Energy 7000.0*GeV



cd /Herwig/MatrixElements/Matchbox/Scales/
set  /Herwig/Merging/MScale:ScaleChoice LeptonPairMassScale



cd /Herwig/Generators
set LHCGenerator:EventHandler:DecayHandler NULL
set LHCGenerator:EventHandler:HadronizationHandler NULL





cd /Herwig/Analysis
clear /Herwig/Generators/LHCGenerator:AnalysisHandlers

create ThePEG::RivetAnalysis RivetAnalysis RivetAnalysis.so
insert /Herwig/Generators/LHCGenerator:AnalysisHandlers 0 RivetAnalysis


cd /Herwig/Generators
set /Herwig/Generators/LHCGenerator:IntermediateOutput Yes 
set /Herwig/Generators/LHCGenerator:EventHandler /Herwig/EventHandlers/LHCHandler
set /Herwig/DipoleShower/DipoleShowerHandler:MaxPtIsMuF Yes 


cd /Herwig/Cuts

set QCDCuts:Fuzzy FuzzyTheta
set MatchboxJetMatcher:Factory /Herwig/Merging/PPMFactory
cd /Herwig/Merging
set PPMFactory:MergingHelper Merger
set Merger:MFactory PPMFactory
set MScale:MergingHelper Merger
set Merger:MergingJetFinder /Herwig/Cuts/JetFinder


cd /Herwig/Generators
set LHCGenerator:DebugLevel 1
set LHCGenerator:PrintEvent 10
set /Herwig/DipoleShower/DipoleShowerHandler:MergingHelper:minusL No



##################################################
# select the analyses
##################################################
# General analysis
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 MC_ZINC
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 MC_ZJETS
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 MC_ZKTSPLITTINGS
# ATLAS pT
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 ATLAS_2011_S9131140
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 ATLAS_2014_I1300647
# ATLAS Z+jets
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 ATLAS_2011_I945498
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 ATLAS_2013_I1230812
# ATLAS phi*
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 ATLAS_2012_I1204784
# CMS Z + b-hadron
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 CMS_2013_I1256943
# CMS Z pt and y
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 CMS_2012_I941555
# ATLAS Z + bjets
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 ATLAS_2014_I1306294
# ATLAS Z
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 ATLAS_2011_I928289_Z
# CMS Z AFB
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 CMS_2013_I1122847
# CMS Z+jets
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 CMS_2015_I1310737
# ATLAS event shapes in Z events
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 ATLAS_2016_I1424838
# ATLAS forwrd backward
insert /Herwig/Analysis/RivetAnalysis:Analyses 0 ATLAS_2015_I1351916_EL



cd /Herwig/DipoleShower/Kernels
set FFgx2ggxDipoleKernel:CMWScheme On
set FFqx2qgxDipoleKernel:CMWScheme On
set FFgx2ddxDipoleKernel:CMWScheme On
set FFgx2uuxDipoleKernel:CMWScheme On
set FFgx2ccxDipoleKernel:CMWScheme On
set FFgx2ssxDipoleKernel:CMWScheme On
set FFgx2bbxDipoleKernel:CMWScheme On
set FFMgx2ggxDipoleKernel:CMWScheme On
set FFMdx2dgxDipoleKernel:CMWScheme On
set FFMux2ugxDipoleKernel:CMWScheme On
set FFMcx2cgxDipoleKernel:CMWScheme On
set FFMsx2sgxDipoleKernel:CMWScheme On
set FFMbx2bgxDipoleKernel:CMWScheme On
set FFMtx2tgxDipoleKernel:CMWScheme On
set FFMgx2ddxDipoleKernel:CMWScheme On
set FFMgx2uuxDipoleKernel:CMWScheme On
set FFMgx2ccxDipoleKernel:CMWScheme On
set FFMgx2ssxDipoleKernel:CMWScheme On
set FFMgx2bbxDipoleKernel:CMWScheme On
set FIgx2ggxDipoleKernel:CMWScheme On
set FIqx2qgxDipoleKernel:CMWScheme On
set FIgx2ddxDipoleKernel:CMWScheme On
set FIgx2uuxDipoleKernel:CMWScheme On
set FIgx2ccxDipoleKernel:CMWScheme On
set FIgx2ssxDipoleKernel:CMWScheme On
set FIgx2bbxDipoleKernel:CMWScheme On
set FIMdx2dgxDipoleKernel:CMWScheme On
set FIMux2ugxDipoleKernel:CMWScheme On
set FIMcx2cgxDipoleKernel:CMWScheme On
set FIMsx2sgxDipoleKernel:CMWScheme On
set FIMbx2bgxDipoleKernel:CMWScheme On
set FIMtx2tgxDipoleKernel:CMWScheme On
set FIMgx2ddxDipoleKernel:CMWScheme On
set FIMgx2uuxDipoleKernel:CMWScheme On
set FIMgx2ccxDipoleKernel:CMWScheme On
set FIMgx2ssxDipoleKernel:CMWScheme On
set FIMgx2bbxDipoleKernel:CMWScheme On
#set FIMgx2ttxDipoleKernel:CMWScheme On
set IFgx2ggxDipoleKernel:CMWScheme On
set IFqx2qgxDipoleKernel:CMWScheme On
set IFqx2gqxDipoleKernel:CMWScheme On
set IFgx2ddbarxDipoleKernel:CMWScheme On
set IFgx2dbardxDipoleKernel:CMWScheme On
set IFgx2uubarxDipoleKernel:CMWScheme On
set IFgx2ubaruxDipoleKernel:CMWScheme On
set IFgx2ccbarxDipoleKernel:CMWScheme On
set IFgx2cbarcxDipoleKernel:CMWScheme On
set IFgx2ssbarxDipoleKernel:CMWScheme On
set IFgx2sbarsxDipoleKernel:CMWScheme On
set IFMgx2ggxDipoleKernel:CMWScheme On
set IFMqx2qgxDipoleKernel:CMWScheme On
set IFMqx2gqxDipoleKernel:CMWScheme On
set IFMgx2ddbarxDipoleKernel:CMWScheme On
set IFMgx2dbardxDipoleKernel:CMWScheme On
set IFMgx2uubarxDipoleKernel:CMWScheme On
set IFMgx2ubaruxDipoleKernel:CMWScheme On
set IFMgx2ccbarxDipoleKernel:CMWScheme On
set IFMgx2cbarcxDipoleKernel:CMWScheme On
set IFMgx2ssbarxDipoleKernel:CMWScheme On
set IFMgx2sbarsxDipoleKernel:CMWScheme On
set IIgx2ggxDipoleKernel:CMWScheme On
set IIqx2qgxDipoleKernel:CMWScheme On
set IIqx2gqxDipoleKernel:CMWScheme On
set IIgx2ddbarxDipoleKernel:CMWScheme On
set IIgx2dbardxDipoleKernel:CMWScheme On
set IIgx2uubarxDipoleKernel:CMWScheme On
set IIgx2ubaruxDipoleKernel:CMWScheme On
set IIgx2ccbarxDipoleKernel:CMWScheme On
set IIgx2cbarcxDipoleKernel:CMWScheme On
set IIgx2ssbarxDipoleKernel:CMWScheme On
set IIgx2sbarsxDipoleKernel:CMWScheme On
