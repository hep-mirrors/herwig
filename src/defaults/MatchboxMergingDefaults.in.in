################################################################################
#
# Default setup for Matchbox matrix element generation.
# You do not need to make any change in here; processes of
# interest can be chosen in the standard input files.
#
################################################################################


################################################################################
# Integration/sampling
################################################################################

cd /Herwig/Samplers

set FlatBinSampler:InitialPoints 10000
set Sampler:BinSampler FlatBinSampler
set Sampler:AddUpSamplers Off
set Sampler:GlobalMaximumWeight Off
set Sampler:FlatSubprocesses Off
set Sampler:MinSelection 0.000001
set Sampler:AlmostUnweighted Off
set Sampler:RunCombinationData Off
set Sampler:WriteGridsOnFinish No
set Sampler:MaxEnhancement 1.1

################################################################################
# Setup the factory object for merging
################################################################################

mkdir /Herwig/Merging
cd /Herwig/Merging


create Herwig::MFactory MFactory HwDipoleShower.so 

do MFactory:StartParticleGroup p
insert MFactory:ParticleGroup 0 /Herwig/Particles/b
insert MFactory:ParticleGroup 0 /Herwig/Particles/bbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/c
insert MFactory:ParticleGroup 0 /Herwig/Particles/cbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/s
insert MFactory:ParticleGroup 0 /Herwig/Particles/sbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/d
insert MFactory:ParticleGroup 0 /Herwig/Particles/dbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/u
insert MFactory:ParticleGroup 0 /Herwig/Particles/ubar
insert MFactory:ParticleGroup 0 /Herwig/Particles/g
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup pbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/b
insert MFactory:ParticleGroup 0 /Herwig/Particles/bbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/c
insert MFactory:ParticleGroup 0 /Herwig/Particles/cbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/s
insert MFactory:ParticleGroup 0 /Herwig/Particles/sbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/d
insert MFactory:ParticleGroup 0 /Herwig/Particles/dbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/u
insert MFactory:ParticleGroup 0 /Herwig/Particles/ubar
insert MFactory:ParticleGroup 0 /Herwig/Particles/g
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup j
insert MFactory:ParticleGroup 0 /Herwig/Particles/b
insert MFactory:ParticleGroup 0 /Herwig/Particles/bbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/c
insert MFactory:ParticleGroup 0 /Herwig/Particles/cbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/s
insert MFactory:ParticleGroup 0 /Herwig/Particles/sbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/d
insert MFactory:ParticleGroup 0 /Herwig/Particles/dbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/u
insert MFactory:ParticleGroup 0 /Herwig/Particles/ubar
insert MFactory:ParticleGroup 0 /Herwig/Particles/g
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup u
insert MFactory:ParticleGroup 0 /Herwig/Particles/u
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup ubar
insert MFactory:ParticleGroup 0 /Herwig/Particles/ubar
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup d
insert MFactory:ParticleGroup 0 /Herwig/Particles/d
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup dbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/dbar
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup s
insert MFactory:ParticleGroup 0 /Herwig/Particles/s
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup sbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/sbar
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup c
insert MFactory:ParticleGroup 0 /Herwig/Particles/c
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup cbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/cbar
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup b
insert MFactory:ParticleGroup 0 /Herwig/Particles/b
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup bbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/bbar
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup t
insert MFactory:ParticleGroup 0 /Herwig/Particles/t
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup tbar
insert MFactory:ParticleGroup 0 /Herwig/Particles/tbar
do MFactory:EndParticleGroup


do MFactory:StartParticleGroup g
insert MFactory:ParticleGroup 0 /Herwig/Particles/g
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup gamma
insert MFactory:ParticleGroup 0 /Herwig/Particles/gamma
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup h0
insert MFactory:ParticleGroup 0 /Herwig/Particles/h0
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup W+
insert MFactory:ParticleGroup 0 /Herwig/Particles/W+
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup W-
insert MFactory:ParticleGroup 0 /Herwig/Particles/W-
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup Z0
insert MFactory:ParticleGroup 0 /Herwig/Particles/Z0
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup e+
insert MFactory:ParticleGroup 0 /Herwig/Particles/e+
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup e-
insert MFactory:ParticleGroup 0 /Herwig/Particles/e-
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup mu+
insert MFactory:ParticleGroup 0 /Herwig/Particles/mu+
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup mu-
insert MFactory:ParticleGroup 0 /Herwig/Particles/mu-
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup tau+
insert MFactory:ParticleGroup 0 /Herwig/Particles/tau+
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup tau-
insert MFactory:ParticleGroup 0 /Herwig/Particles/tau-
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup l
insert MFactory:ParticleGroup 0 /Herwig/Particles/e+
insert MFactory:ParticleGroup 0 /Herwig/Particles/mu+
insert MFactory:ParticleGroup 0 /Herwig/Particles/e-
insert MFactory:ParticleGroup 0 /Herwig/Particles/mu-
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup nu
insert MFactory:ParticleGroup 0 /Herwig/Particles/nu_e
insert MFactory:ParticleGroup 0 /Herwig/Particles/nu_mu
insert MFactory:ParticleGroup 0 /Herwig/Particles/nu_ebar
insert MFactory:ParticleGroup 0 /Herwig/Particles/nu_mubar
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup l+
insert MFactory:ParticleGroup 0 /Herwig/Particles/e+
insert MFactory:ParticleGroup 0 /Herwig/Particles/mu+
do MFactory:EndParticleGroup

do MFactory:StartParticleGroup l-
insert MFactory:ParticleGroup 0 /Herwig/Particles/e-
insert MFactory:ParticleGroup 0 /Herwig/Particles/mu-
do MFactory:EndParticleGroup

################################################################################
# Setup amplitudes
################################################################################

cd /Herwig/MatrixElements/Matchbox/Amplitudes/Builtin

insert /Herwig/Merging/MFactory:Amplitudes 0 Amplitudellbarqqbar
insert /Herwig/Merging/MFactory:Amplitudes 0 Amplitudellbarqqbarg
insert /Herwig/Merging/MFactory:Amplitudes 0 Amplitudellbarqqbargg
insert /Herwig/Merging/MFactory:Amplitudes 0 Amplitudellbarqqbarqqbar
insert /Herwig/Merging/MFactory:Amplitudes 0 Amplitudelnuqqbar
insert /Herwig/Merging/MFactory:Amplitudes 0 Amplitudelnuqqbarg
insert /Herwig/Merging/MFactory:Amplitudes 0 Amplitudelnuqqbargg
insert /Herwig/Merging/MFactory:Amplitudes 0 Amplitudelnuqqbarqqbar
insert /Herwig/Merging/MFactory:Amplitudes 0 Amplitudehgg
insert /Herwig/Merging/MFactory:Amplitudes 0 Amplitudehggg

################################################################################
# Setup utilities for process generation
################################################################################

cd /Herwig/MatrixElements/Matchbox
cd Utility
set /Herwig/Merging/MFactory:DiagramGenerator DiagramGenerator
set /Herwig/Merging/MFactory:ProcessData ProcessData 

################################################################################
# Setup phasespace generators
################################################################################

cd /Herwig/MatrixElements/Matchbox
cd Phasespace
set /Herwig/Merging/MFactory:Phasespace TreePhasespace

################################################################################
# Setup scale choices
################################################################################

cd /Herwig/Merging
create Herwig::MScale MScale 
set MFactory:ScaleChoice MScale


create Herwig::Merger Merger
create Herwig::MergingReweight MPreWeight HwDipoleShower.so
insert MFactory:Preweighters 0  MPreWeight

create Herwig::SimpleColourBasis  LargeNColourBasis
set LargeNColourBasis:LargeN On
set Merger:LargeNBasis LargeNColourBasis


################################################################################
# Factories for different colliders
################################################################################


set /Herwig/Cuts/JetKtCut:MinKT 0.0*GeV


cp MFactory EEMFactory
set EEMFactory:PartonExtractor /Herwig/Partons/EEExtractor
set EEMFactory:Cuts /Herwig/Cuts/EECuts
set EEMFactory:FirstPerturbativePDF No
set EEMFactory:SecondPerturbativePDF No

cp MFactory DISMFactory

set DISMFactory:PartonExtractor /Herwig/Partons/DISExtractor
set DISMFactory:Cuts /Herwig/Cuts/DISCuts
set DISMFactory:FirstPerturbativePDF No
set DISMFactory:SecondPerturbativePDF Yes

cp MFactory PPMFactory
set PPMFactory:PartonExtractor /Herwig/Partons/QCDExtractor
set PPMFactory:Cuts /Herwig/Cuts/QCDCuts
set PPMFactory:FirstPerturbativePDF Yes
set PPMFactory:SecondPerturbativePDF Yes

cd /

