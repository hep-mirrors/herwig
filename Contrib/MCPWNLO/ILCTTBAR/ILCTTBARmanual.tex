\documentclass[12pt,a4paper,oneside]{article}
%\documentclass{article}
%\usepackage{afterpage}
%\usepackage[hang,small,bf]{caption}
%\usepackage{fancyhdr}
%\usepackage[something]{optional}
%\usepackage[todo, question, colour]{optional}
%\usepackage{epsfig,axodraw}
%\usepackage{array,cite,amsmath,amssymb}
%\usepackage{cite}
%\usepackage{makeidx}
%\usepackage{doublespace}  % This doesn't work with FeynArts diagrams
%\usepackage{array}
%\usepackage{multicol}
%\usepackage{subfigure}
%\usepackage{rotating}
%\usepackage{amssymb}
\usepackage{setspace}
\usepackage{booktabs}
%\input{psfig.tex}
%\usepackage{psfig}
\oddsidemargin=-0.05in
\textwidth=6.9in
\topmargin=-0.8in
\textheight=9.55in
%\reqno
%\newcounter{table}
\addtocounter{table}{0}
\usepackage{hyperref}
\usepackage{epsfig,bm,amsmath}
\onehalfspacing
% \makeatletter
% \DeclareRobustCommand{\Cpp}
% {\valign{\vfil\hbox{##}\vfil\cr
%    \textsf{C\kern-.1em}\cr
%    $\hbox{\fontsize{\sf@size}{0}\textbf{+\kern-0.05em+}}$\cr}%
% }
\begin{document}
\begin{center}
\Large \textbf {ILC top pair production and decay with {\tt MCPWNLO}} \\
\end{center}
\section{Introduction}
This manual describes how to generate $e^+e^-$ annihilation events at the ILC with NLO accuracy using the {\tt POWHEG} \cite{Nason:2004rx} method. More details on the use and application of the program and its interface with {\tt Herwig++} \cite{Bahr:2008pv} can be found in \cite{LatundeDada:2008bv}.
\section{Setting the parameters}
Within the directory {\tt MCPWNLO/ILCTTBAR}, the file {\tt ILCTTBAR\_INPUTS.h} includes all the available user parameters
for the main program {\tt ILCTTBAR.cxx} for {\tt
  POWHEG} event generation. The parameters are:\\
\\
{\tt double cme}: The center of mass energy in GeV e.g. $500$ for ILC. \\
{\tt  int Pem}: Polarization of the beam electrons (1 for right-handed helicity or -1 for left-handed helicity).\\
{\tt  int Pep}: Polarization of the beam positrons (1 or -1).\\
{\tt double Mz}: Pole mass of the $Z$ boson in GeV.\\
{\tt int nevgen}: Number of events to generate (typically $\approx 10^5$). \\
{\tt int rseed}:  Initial seed for the random number generator. \\ 
{\tt bool POWHEGprod}: Set to {\tt true} if the {\tt POWHEG} method is to be used for production. \\
{\tt bool POWHEGdecay}: Set to {\tt true} if the {\tt POWHEG} method is to be used for the decays. \\
{\tt bool truncpro}: Set to {\tt true} if the truncated shower is to be switched on in the
production process. \\
{\tt bool truncdec}: Set to {\tt true} if the truncated shower is to be switched on in the
decay process.\\
\section{Generating partonic events}
After setting the parameters, open the {\tt Makefile} and set {\tt HERWIGDIR} to the address of the {\tt Herwig} folder
in the directory {\tt MCPWNLO}. 
To run {\tt ILCTTBAR.cxx}, in the directory {\tt ILCTTBAR}, type the following commands :\\
\\
{\tt make clean} \\
{\tt make} \\
\\
This creates the executable {\tt ILCTTBAR} and {\tt run\_ilc} (which is moved to {\tt
  HERWIGDIR}). Next, type: \\
\\
{\tt ./ILCTTBAR} \\ 
\\
This runs the main program and generates the Les Houches file for interface with \textsf{Herwig++}. This file will be called {\tt ILCTTBAR.dat} and contains unweighted events with absolute weights
of $1$.
\section{{\tt POWHEG} requirements}
If running {\tt POWHEG}, go to the folder {\tt PWInstallFiles} in the main {\tt MCPWNLO}
directory. There you will find the following files:\\
{\tt Evolver.cc} {\tt Evolver.h} {\tt Evolver.icc} {\tt PartnerFinder.cc}  {\tt PartnerFinder.h}  {\tt PartnerFinder.icc}
Replace the files of the same names in {\tt /Shower/Base} folder of your \textsf{Herwig++}
installation directory. Then go back to the {\tt Shower} folder (not in {\tt Base}!) and type: \\
\\
{\tt make} \\
{\tt make install} \\
\\
This allows us to veto the shower and set the colour partner of the hardest emission correctly for {\tt
  POWHEG}.
\section{Analysis} 

In the folder {\tt ILCAnalysis} in the {\tt ILCTTBAR} directory are some analysis files
which analyze the events after interfacing the Les Houches file with
\textsf{Herwig++}. \\ The
{\tt SimpleILCAnalysis.cc} file contains the main program which provides
histograms for various distributions. Open the {\tt Makefile} and set {\tt HPDIR} and
{\tt THEPEGDIR} to the folder where you installed \textsf{Herwig++} and \textsf{ThePEG}. Compile the directory by typing the following commands\\
\\
{\tt make} \\
{\tt make install} \\
\\
in the {\tt ILCAnalysis} directory. This recreates the {\tt SimpleILCAnalysis.so} library.

\section{Interfacing with \textsf{Herwig++}}
Having generated the Les Houches file and set up the analysis handlers, the next step is to
run \textsf{Herwig++}. It is assumed that both \textsf{Herwig++} and \textsf{ThePEG} have
already been installed on your system. 

Now go to the directory {\tt MCPWNLO/Herwig} and open the initialization file {\tt
  ILCTTB.in}. This contains \textsf{Herwig++} user parameters which can be set. A selection of
these are:\\
\\
{\tt set Reader2:FileName TTB.dat}: This is the filename for the Les Houches file your
generated file is converted into by the program {\tt ILCTTBAR/run\_ilc.cxx}. Leave this
as it is! \\
{\tt set Reader2:EBeamA 250.0}: The beam energy in GeV of the electrons. \\
{\tt set Reader2:EBeamB 250.0}: The beam energy in GeV of the positrons.\\
{\tt set LesHouchesHandler:WeightOption UnitWeight}: The weight option for the
events. \\
{\tt insert SimpleEE:MatrixElements 0 MEee2gZ2qq}: The hard process. Here it's set up for
$Z$/gamma production and decay into $q \bar{q}$ pairs.\\
{\tt set MEee2gZ2qq:MinimumFlavour 6}: These sets the decays exclusively into top pairs. \\
{\tt set MEee2gZ2qq:MaximumFlavour 6}: These sets the decays exclusively into top pairs. \\
{\tt set /Herwig/Shower/Evolver:HardVetoMode 1}: The veto mode to be applied. For {\tt
  POWHEG}, this should be set to $1$.\\
{\tt set /Herwig/Shower/Evolver:POWHEGTOPVeto 1}: The {\tt POWHEG} top veto mode to be
applied.\\
{\tt set /Herwig/Shower/PartnerFinder:PHPartnerFinder 1}: The partner finder option. This
should be set to $1$ for {\tt POWHEG}.\\
\\
Having set up the initialization file, run \textsf{Herwig++} by typing the following
commands: \\
\\
{\tt ./run\_ilc [eventfile] [number of events]} \\
\\
An example of the run
command is:\\
\\
{\tt ./run\_ilc /usera/seyi/MCPWNLO/ILCTTBAR/ILCTTBAR.dat 10000}\\
\\
where you should replace the eventfile with the path to your Les Houches file.
\\
  At the end of the run, a topdrawer file {\tt MG\_SimpleILC.top}  will be
  produced containing the histograms booked by the analysis handler. If you have topdraw
  installed, you can convert this to a postscript file by typing the command:\\
\\
{\tt td -dPOSTSCRIPT  *.top}
\section{Further Information}
For further information about {\tt MCPWNLO} contact: {\tt seyi@hep.phy.cam.ac.uk}.
\bibliography{manual}
\bibliographystyle{utphys}
\end{document}
%%% Local Variables: 
%%% mode: latex
%%% TeX-master: t
%%% End: 
