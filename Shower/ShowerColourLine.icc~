// -*- C++ -*-
//
// This is the implementation of the inlined member functions of
// the ShowerColourLine class.
//

namespace Herwig {

inline ShowerColourLine::ShowerColourLine() {}

inline ShowerColourLine::ShowerColourLine(const ShowerColourLine & x)
  : theColoured(x.theColoured),
    theAntiColoured(x.theAntiColoured),
    theSourceNeighbours(x.theSourceNeighbours),
    theSinkNeighbours(x.theSinkNeighbours) {}

inline const tCollecShoParPtr & ShowerColourLine::coloured() const {
  return theColoured;
}

inline const tCollecShoParPtr & ShowerColourLine::antiColoured() const {
  return theAntiColoured;
}

inline tShoParPtr ShowerColourLine::startParticle() const {
  return sinkNeighbours().first? tShoParPtr(): antiColoured().back();
}

inline tShoParPtr ShowerColourLine::endParticle() const {
  return sourceNeighbours().first? tShoParPtr(): coloured().back();
}

inline tShoColinePair ShowerColourLine::sinkNeighbours() const {
  return theSinkNeighbours;
}

inline tShoColinePair ShowerColourLine::sourceNeighbours() const {
  return theSourceNeighbours;
}

inline void ShowerColourLine::setSinkNeighbours(tShoColinePtr l1, tShoColinePtr l2) {
  theSinkNeighbours.second = l1->theSinkNeighbours.second = l2;
  l2->theSinkNeighbours.second = theSinkNeighbours.first = l1;
  l1->theSinkNeighbours.first = l2->theSinkNeighbours.first = this;
}

inline void ShowerColourLine::setSourceNeighbours(tShoColinePtr l1, tShoColinePtr l2) {
  theSourceNeighbours.second = l1->theSourceNeighbours.second = l2;
  l2->theSourceNeighbours.second = theSourceNeighbours.first = l1;
  l1->theSourceNeighbours.first = l2->theSourceNeighbours.first = this;
}

}
